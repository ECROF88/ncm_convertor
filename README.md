# 网易云音乐NCM文件转换器

一个带有图形用户界面的网易云音乐NCM文件转换工具，基于Python、PySide6和ncmdump库开发。

## 功能特性

- 🎵 批量转换NCM格式文件到标准音频格式
- 🖥️ 简洁友好的图形用户界面
- 📊 实时转换进度显示
- 📝 详细的转换日志
- 🎛️ 自定义输出目录选择
- ⚡ 多线程转换，不阻塞界面
- 📁 支持文件夹批量选择
- 🔄 跳过已存在文件选项
- 💾 设置自动保存和恢复
- 📋 日志导出功能

## 版本说明

项目包含两个版本：

### 基础版本 (`main.py`)
- 简洁的界面设计
- 基本的文件转换功能
- 适合简单使用场景

### 高级版本 (`advanced_main.py`)
- 更丰富的功能
- 文件夹批量选择
- 详细的日志记录
- 设置保存和恢复
- 更完善的错误处理
- 转换进度统计

## 安装依赖

使用uv安装项目依赖：

```bash
uv sync
```

或手动安装依赖：

```bash
uv add ncmdump PySide6 mutagen
```

## 使用方法

### 启动基础版本：
```bash
uv run main.py
```

### 启动高级版本：
```bash
uv run advanced_main.py
```

### 使用Windows批处理脚本：
```bash
start.bat
```

### 使用界面：
1. 点击"选择NCM文件"添加要转换的.ncm文件
   - 高级版本还支持"选择文件夹"功能
2. 点击"选择输出目录"设置转换后文件的保存位置
3. 配置转换选项（高级版本）
   - 跳过已存在的文件
4. 点击"开始转换"开始批量转换
5. 在日志区域查看转换进度和结果

## 项目结构

```
ncm-transfer/
├── main.py              # 基础版本主程序
├── advanced_main.py     # 高级版本主程序
├── pyproject.toml       # 项目配置
├── requirements.txt     # pip依赖文件
├── start.bat           # Windows启动脚本
├── README.md           # 说明文档
├── .gitignore          # Git忽略文件
└── logs/               # 日志文件夹（运行时创建）
```

## 技术栈

- **Python 3.13+**: 主要编程语言
- **PySide6**: GUI框架
- **ncmdump**: NCM文件解码库
- **mutagen**: 音频元数据处理（预留扩展功能）

## 高级功能说明

### 日志系统
- 实时显示转换进度
- 支持日志导出到文件
- 自动创建带时间戳的日志文件

### 设置保存
- 自动记住上次使用的输出目录
- 保存转换选项设置
- 下次启动时自动恢复

### 批量处理
- 支持一次选择多个文件
- 支持选择整个文件夹进行批量转换
- 智能跳过已转换的文件

### 错误处理
- 详细的错误信息显示
- 转换失败时继续处理其他文件
- 完整的错误日志记录

## 注意事项

- 确保您有合法的网易云音乐文件使用权限
- 转换过程可能需要一些时间，请耐心等待
- 建议在转换前备份原始文件
- 高级版本会在程序目录下创建logs文件夹存储日志

## 故障排除

### 常见问题

1. **应用无法启动**
   - 确保已正确安装所有依赖
   - 检查Python版本是否为3.13+

2. **转换失败**
   - 检查NCM文件是否损坏
   - 确保有足够的磁盘空间
   - 检查输出目录是否有写入权限

3. **界面显示异常**
   - 确保PySide6版本正确
   - 尝试重新安装依赖

## 许可证

本项目仅供学习和个人使用，请遵守相关法律法规和版权规定。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！